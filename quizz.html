<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ПМ-03</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            color: var(--dark-color);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab-btn.active {
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary-color);
        }
        
        .tab-btn:disabled {
            color: #ccc;
            cursor: not-allowed;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Викторина стили */
        .quiz-settings {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input[type="number"], select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-start {
            background-color: var(--success-color);
        }
        
        .btn-start:hover {
            background-color: #27ae60;
        }
        
        /* Вопрос викторины */
        .quiz-container {
            display: none;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .question {
            font-size: 1.5rem;
            margin-bottom: 30px;
            font-weight: 600;
        }
        
        .answers {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .answer-btn {
            padding: 15px;
            background-color: var(--light-color);
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            text-align: left;
        }
        
        .answer-btn:hover {
            background-color: #e0e0e0;
            border-color: #bbb;
        }
        
        .answer-btn.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--secondary-color);
        }
        
        .progress {
            margin-bottom: 20px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        /* Результаты */
        .results-container {
            display: none;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .results-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: var(--light-color);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 1.1rem;
            color: var(--dark-color);
        }
        
        .answers-review {
            margin-top: 30px;
        }
        
        .answer-item {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        
        .answer-item.correct {
            border-left: 5px solid var(--success-color);
        }
        
        .answer-item.incorrect {
            border-left: 5px solid var(--accent-color);
        }
        
        .user-answer {
            font-weight: 600;
            margin-top: 10px;
        }
        
        .correct-answer {
            font-weight: 600;
            margin-top: 5px;
            color: var(--success-color);
        }
        
        /* Таблица вопросов */
        .questions-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .questions-table th, .questions-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .questions-table th {
            background-color: var(--primary-color);
            color: white;
        }
        
        .questions-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .questions-table tr:hover {
            background-color: #e9e9e9;
        }
        
        /* Адаптивность */
        @media (max-width: 768px) {
            .stats {
                grid-template-columns: 1fr;
            }
            
            .question {
                font-size: 1.3rem;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>ПМ-03</h1>
        </div>
    </header>
    
    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" data-tab="quiz">Викторина</button>
            <button class="tab-btn" data-tab="questions" id="questions-tab">Вопросы и ответы</button>
        </div>
        
        <div class="tab-content active" id="quiz">
            <div class="quiz-settings" id="quiz-settings">
                <div class="form-group">
                    <label for="question-count">Количество вопросов:</label>
                    <input type="number" id="question-count" min="1" value="5">
                    <small>Или выберите "Все вопросы" ниже</small>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="all-questions"> Все вопросы
                    </label>
                </div>
                
                <button class="btn btn-start" id="start-quiz">Начать викторину</button>
            </div>
            
            <div class="quiz-container" id="quiz-container">
                <div class="progress" id="progress">Вопрос 1 из 5</div>
                <div class="question" id="question">Текст вопроса</div>
                <div class="answers" id="answers">
                    <!-- Варианты ответов будут здесь -->
                </div>
                <button class="btn" id="next-btn">Следующий вопрос</button>
            </div>
            
            <div class="results-container" id="results-container">
                <h2 class="results-title">Результаты викторины</h2>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value" id="correct-answers">0</div>
                        <div class="stat-label">Правильных ответов</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="incorrect-answers">0</div>
                        <div class="stat-label">Неправильных ответов</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="streak">0</div>
                        <div class="stat-label">Максимальная серия</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="percentage">0%</div>
                        <div class="stat-label">Процент правильных</div>
                    </div>
                </div>
                
                <div class="answers-review" id="answers-review">
                    <h3>Проверка ответов:</h3>
                    <!-- Ответы будут здесь -->
                </div>
                
                <button class="btn" id="restart-btn">Начать заново</button>
            </div>
        </div>
        
        <div class="tab-content" id="questions">
            <h2>Вопросы и правильные ответы</h2>
            <table class="questions-table">
                <thead>
                    <tr>
                        <th>№</th>
                        <th>Вопрос</th>
                        <th>Правильный ответ</th>
                    </tr>
                </thead>
                <tbody id="questions-table-body">
                    <!-- Вопросы будут здесь -->
                </tbody>
            </table>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab switching
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            const questionsTabBtn = document.getElementById('questions-tab');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (this.disabled) return;
                    
                    const tabId = this.getAttribute('data-tab');
                    
                    // Remove active class from all buttons and contents
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding content
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Quiz variables
            let questions = [];
            let currentQuestionIndex = 0;
            let selectedAnswers = [];
            let correctAnswersCount = 0;
            let incorrectAnswersCount = 0;
            let currentStreak = 0;
            let maxStreak = 0;
            let quizActive = false;
            let selectedQuestions = [];
            
            // DOM elements
            const quizSettings = document.getElementById('quiz-settings');
            const quizContainer = document.getElementById('quiz-container');
            const resultsContainer = document.getElementById('results-container');
            const startQuizBtn = document.getElementById('start-quiz');
            const nextBtn = document.getElementById('next-btn');
            const restartBtn = document.getElementById('restart-btn');
            const allQuestionsCheckbox = document.getElementById('all-questions');
            const questionCountInput = document.getElementById('question-count');
            
            // Load questions from JSON
            function loadQuestions() {
                // In a real scenario, you would fetch this from a JSON file
                questions = [];

                fetch('pm3.json')
                    .then(res => res.json())
                    .then(data => {
                        questions = data;
                        populateQuestionsTable();
                    })
                    .catch(err => console.error('Ошибка загрузки:', err));
                
                // Populate questions table
                function populateQuestionsTable(){
                    const tableBody = document.getElementById('questions-table-body');
                    tableBody.innerHTML = '';
                
                    questions.forEach((q, index) => {
                        const row = document.createElement('tr');
                    
                        const numberCell = document.createElement('td');
                        numberCell.textContent = index + 1;
                    
                        const questionCell = document.createElement('td');
                        questionCell.textContent = q.question;
                    
                        const answerCell = document.createElement('td');
                        answerCell.textContent = q.answer;
                    
                        row.appendChild(numberCell);
                        row.appendChild(questionCell);
                        row.appendChild(answerCell);
                    
                        tableBody.appendChild(row);

                        console.log(q)
                    });
                }
            }
            
            // Start quiz
            startQuizBtn.addEventListener('click', function() {
                const useAllQuestions = allQuestionsCheckbox.checked;
                let questionCount = useAllQuestions ? questions.length : parseInt(questionCountInput.value);
                
                if (questionCount < 1) questionCount = 1;
                if (questionCount > questions.length) questionCount = questions.length;
                
                // Reset quiz state
                currentQuestionIndex = 0;
                selectedAnswers = [];
                correctAnswersCount = 0;
                incorrectAnswersCount = 0;
                currentStreak = 0;
                maxStreak = 0;
                quizActive = true;
                
                // Disable questions tab
                questionsTabBtn.disabled = true;
                
                // Select random questions if not using all
                let quizQuestions;
                if (useAllQuestions) {
                    quizQuestions = [...questions];
                } else {
                    // Shuffle array and pick first N questions
                    quizQuestions = [...questions].sort(() => 0.5 - Math.random()).slice(0, questionCount);
                }
                
                // Store selected questions
                selectedQuestions = quizQuestions;
                
                // Show quiz container
                quizSettings.style.display = 'none';
                quizContainer.style.display = 'block';
                resultsContainer.style.display = 'none';
                
                // Load first question
                loadQuestion(currentQuestionIndex);
            });
            
            // Load question
            function loadQuestion(index) {
                if (index >= selectedQuestions.length) {
                    showResults();
                    return;
                }
                
                const question = selectedQuestions[index];
                document.getElementById('question').textContent = question.question;
                document.getElementById('progress').textContent = `Вопрос ${index + 1} из ${selectedQuestions.length}`;
                
                // Prepare answers (correct + wrong)
                const answers = [question.answer, ...question.wrong_answers];
                
                // Shuffle answers
                const shuffledAnswers = answers.sort(() => 0.5 - Math.random());
                
                // Display answers
                const answersContainer = document.getElementById('answers');
                answersContainer.innerHTML = '';
                
                shuffledAnswers.forEach(answer => {
                    const answerBtn = document.createElement('button');
                    answerBtn.className = 'answer-btn';
                    answerBtn.textContent = answer;
                    
                    answerBtn.addEventListener('click', function() {
                        // Remove selected class from all buttons
                        document.querySelectorAll('.answer-btn').forEach(btn => {
                            btn.classList.remove('selected');
                        });
                        
                        // Add selected class to clicked button
                        this.classList.add('selected');
                        
                        // Store selected answer
                        selectedAnswers[index] = this.textContent;
                    });
                    
                    answersContainer.appendChild(answerBtn);
                });
                
                // Enable/disable next button based on whether an answer is selected
                nextBtn.disabled = true;
            }
            
            // Next question
            nextBtn.addEventListener('click', function() {
                // Check if answer is selected
                if (typeof selectedAnswers[currentQuestionIndex] === 'undefined') {
                    alert('Пожалуйста, выберите ответ');
                    return;
                }
                
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
                
                // Disable next button until answer is selected
                nextBtn.disabled = true;
            });
            
            // Enable next button when answer is selected
            document.getElementById('answers').addEventListener('click', function(e) {
                if (e.target.classList.contains('answer-btn')) {
                    nextBtn.disabled = false;
                }
            });
            
            // Show results
            function showResults() {
                quizActive = false;
                questionsTabBtn.disabled = false;
                
                quizContainer.style.display = 'none';
                resultsContainer.style.display = 'block';
                
                // Calculate results
                selectedQuestions.forEach((question, index) => {
                    const userAnswer = selectedAnswers[index];
                    const isCorrect = userAnswer === question.answer;
                    
                    if (isCorrect) {
                        correctAnswersCount++;
                        currentStreak++;
                        if (currentStreak > maxStreak) maxStreak = currentStreak;
                    } else {
                        incorrectAnswersCount++;
                        currentStreak = 0;
                    }
                });
                
                // Display stats
                document.getElementById('correct-answers').textContent = correctAnswersCount;
                document.getElementById('incorrect-answers').textContent = incorrectAnswersCount;
                document.getElementById('streak').textContent = maxStreak;
                document.getElementById('percentage').textContent = 
                    Math.round((correctAnswersCount / selectedQuestions.length) * 100) + '%';
                
                // Display answers review
                const answersReview = document.getElementById('answers-review');
                answersReview.innerHTML = '<h3>Проверка ответов:</h3>';
                
                selectedQuestions.forEach((question, index) => {
                    const userAnswer = selectedAnswers[index];
                    const isCorrect = userAnswer === question.answer;
                    
                    const answerItem = document.createElement('div');
                    answerItem.className = `answer-item ${isCorrect ? 'correct' : 'incorrect'}`;
                    
                    const questionText = document.createElement('div');
                    questionText.textContent = `${index + 1}. ${question.question}`;
                    questionText.style.fontWeight = '600';
                    
                    const userAnswerText = document.createElement('div');
                    userAnswerText.className = 'user-answer';
                    userAnswerText.textContent = `Ваш ответ: ${userAnswer}`;
                    
                    const correctAnswerText = document.createElement('div');
                    correctAnswerText.className = 'correct-answer';
                    correctAnswerText.textContent = `Правильный ответ: ${question.answer}`;
                    
                    answerItem.appendChild(questionText);
                    answerItem.appendChild(userAnswerText);
                    
                    if (!isCorrect) {
                        answerItem.appendChild(correctAnswerText);
                    }
                    
                    answersReview.appendChild(answerItem);
                });
            }
            
            // Restart quiz
            restartBtn.addEventListener('click', function() {
                resultsContainer.style.display = 'none';
                quizSettings.style.display = 'block';
                quizActive = false;
                questionsTabBtn.disabled = false;
            });
            
            // Toggle all questions checkbox
            allQuestionsCheckbox.addEventListener('change', function() {
                questionCountInput.disabled = this.checked;
            });
            
            // Initialize
            loadQuestions();
        });
    </script>
</body>
</html>
